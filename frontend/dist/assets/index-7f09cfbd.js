import{a as re,o as ie,b as n,D as me,c as E,e as pe,g as e,w as t,f as u,m as b,F as fe,J as ce,K as _e,L as be,I as ve,M as ge,s as ye,y as Ve,N as ke,j as y,i as M,h as i,E as V,C as Ce}from"./index-285e75c9.js";const he={class:"role-management"},we={class:"card-header"},xe={class:"pagination"},Ue={class:"dialog-footer"},Te={class:"dialog-footer"},Ne={class:"dialog-footer"},ze={__name:"index",setup(Ke){const p=M({roleName:"",roleKey:"",status:""}),m=M({current:1,size:10,total:0}),w=i(!1),R=i([]),v=i(!1),k=i(!1),C=i(!1),x=i("add"),N=i(null),s=M({id:"",roleName:"",roleKey:"",description:"",status:"1"}),D={roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:20,message:"角色名称长度在 2 到 20 个字符",trigger:"blur"}],roleKey:[{required:!0,message:"请输入角色代码",trigger:"blur"},{min:2,max:20,message:"角色代码长度在 2 到 20 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}]},j=i([{id:1,label:"系统管理",children:[{id:11,label:"用户管理"},{id:12,label:"角色管理"},{id:13,label:"菜单管理"},{id:14,label:"部门管理"},{id:15,label:"数据字典"},{id:16,label:"系统日志"}]},{id:2,label:"客户管理",children:[{id:21,label:"客户列表"},{id:22,label:"联系人管理"},{id:23,label:"跟进记录"}]},{id:3,label:"销售管理",children:[{id:31,label:"商机管理"},{id:32,label:"合同管理"},{id:33,label:"订单管理"},{id:34,label:"回款管理"}]},{id:4,label:"数据统计",children:[{id:41,label:"客户统计"},{id:42,label:"销售统计"},{id:43,label:"商机统计"},{id:44,label:"回款统计"}]}]),S=i([]),A=i([{key:1,label:"管理员",disabled:!1},{key:2,label:"普通用户",disabled:!1}]),z=i([]),f=async()=>{w.value=!0;try{setTimeout(()=>{R.value=[{id:1,roleName:"管理员",roleKey:"admin",description:"系统管理员",status:"1",createTime:"2023-01-01 10:00:00"},{id:2,roleName:"销售经理",roleKey:"sales_manager",description:"销售经理",status:"1",createTime:"2023-01-02 10:00:00"},{id:3,roleName:"销售顾问",roleKey:"sales_consultant",description:"销售顾问",status:"1",createTime:"2023-01-03 10:00:00"},{id:4,roleName:"普通用户",roleKey:"user",description:"普通用户",status:"1",createTime:"2023-01-04 10:00:00"}],m.total=4,w.value=!1},500)}catch(o){console.error("获取角色列表失败:",o),V.error("获取角色列表失败"),w.value=!1}},F=()=>{m.current=1,f()},I=()=>{Object.keys(p).forEach(o=>{p[o]=""}),m.current=1,f()},O=o=>{m.size=o,f()},q=o=>{m.current=o,f()},L=()=>{x.value="add",Object.keys(s).forEach(o=>{s[o]=""}),s.status="1",v.value=!0},J=o=>{x.value="edit",Object.assign(s,o),v.value=!0},P=async()=>{if(N.value)try{await N.value.validate(),setTimeout(()=>{v.value=!1,V.success(x.value==="add"?"新增角色成功":"编辑角色成功"),f()},500)}catch(o){console.error("表单验证失败:",o)}},G=o=>{S.value=[1,11,12,13,14,15,16,2,21,22,23,3,31,32,33,34,4,41,42,43,44],k.value=!0},H=(o,l,r)=>{console.log("菜单勾选变化:",o,l,r)},Q=()=>{setTimeout(()=>{k.value=!1,V.success("菜单权限设置成功")},500)},W=o=>{z.value=[1],C.value=!0},X=(o,l,r)=>{console.log("用户转移变化:",o,l,r)},Y=()=>{setTimeout(()=>{C.value=!1,V.success("用户授权设置成功")},500)},Z=o=>{setTimeout(()=>{V.success("状态更新成功")},500)},ee=o=>{Ce.confirm("确定要删除该角色吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{setTimeout(()=>{V.success("删除角色成功"),f()},500)}).catch(()=>{})};return ie(()=>{f()}),(o,l)=>{const r=n("el-icon"),d=n("el-button"),h=n("el-input"),c=n("el-form-item"),U=n("el-col"),T=n("el-option"),$=n("el-select"),le=n("el-row"),B=n("el-form"),_=n("el-table-column"),te=n("el-switch"),ae=n("el-table"),oe=n("el-pagination"),ne=n("el-card"),K=n("el-dialog"),se=n("el-tree"),de=n("el-transfer"),ue=me("loading");return E(),pe("div",he,[e(ne,null,{header:t(()=>[u("div",we,[l[17]||(l[17]=u("span",null,"角色管理",-1)),e(d,{type:"primary",onClick:L},{default:t(()=>[e(r,null,{default:t(()=>[e(b(fe))]),_:1}),l[16]||(l[16]=u("span",null,"新增角色",-1))]),_:1})])]),default:t(()=>[e(B,{model:p,class:"search-form","label-width":"80px"},{default:t(()=>[e(le,{gutter:20},{default:t(()=>[e(U,{span:6},{default:t(()=>[e(c,{label:"角色名称"},{default:t(()=>[e(h,{modelValue:p.roleName,"onUpdate:modelValue":l[0]||(l[0]=a=>p.roleName=a),placeholder:"请输入角色名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(U,{span:6},{default:t(()=>[e(c,{label:"角色代码"},{default:t(()=>[e(h,{modelValue:p.roleKey,"onUpdate:modelValue":l[1]||(l[1]=a=>p.roleKey=a),placeholder:"请输入角色代码",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(U,{span:6},{default:t(()=>[e(c,{label:"状态"},{default:t(()=>[e($,{modelValue:p.status,"onUpdate:modelValue":l[2]||(l[2]=a=>p.status=a),placeholder:"请选择状态",clearable:""},{default:t(()=>[e(T,{label:"启用",value:"1"}),e(T,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(U,{span:24,class:"search-buttons"},{default:t(()=>[e(d,{type:"primary",onClick:F},{default:t(()=>[e(r,null,{default:t(()=>[e(b(ce))]),_:1}),l[18]||(l[18]=u("span",null,"查询",-1))]),_:1}),e(d,{onClick:I},{default:t(()=>[e(r,null,{default:t(()=>[e(b(_e))]),_:1}),l[19]||(l[19]=u("span",null,"重置",-1))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),be((E(),ve(ae,{data:R.value,style:{width:"100%"},border:""},{default:t(()=>[e(_,{prop:"id",label:"角色ID",width:"80"}),e(_,{prop:"roleName",label:"角色名称",width:"150"}),e(_,{prop:"roleKey",label:"角色代码",width:"150"}),e(_,{prop:"description",label:"角色描述"}),e(_,{prop:"status",label:"状态",width:"100"},{default:t(a=>[e(te,{modelValue:a.row.status,"onUpdate:modelValue":g=>a.row.status=g,"active-value":"1","inactive-value":"0",onChange:g=>Z(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(_,{prop:"createTime",label:"创建时间",width:"180"}),e(_,{label:"操作",width:"250",fixed:"right"},{default:t(a=>[e(d,{type:"primary",size:"small",onClick:g=>J(a.row)},{default:t(()=>[e(r,null,{default:t(()=>[e(b(ge))]),_:1}),l[20]||(l[20]=u("span",null,"编辑",-1))]),_:1},8,["onClick"]),e(d,{type:"success",size:"small",onClick:g=>G(a.row)},{default:t(()=>[e(r,null,{default:t(()=>[e(b(ye))]),_:1}),l[21]||(l[21]=u("span",null,"菜单权限",-1))]),_:1},8,["onClick"]),e(d,{type:"warning",size:"small",onClick:g=>W(a.row)},{default:t(()=>[e(r,null,{default:t(()=>[e(b(Ve))]),_:1}),l[22]||(l[22]=u("span",null,"用户授权",-1))]),_:1},8,["onClick"]),e(d,{type:"danger",size:"small",onClick:g=>ee(a.row.id)},{default:t(()=>[e(r,null,{default:t(()=>[e(b(ke))]),_:1}),l[23]||(l[23]=u("span",null,"删除",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ue,w.value]]),u("div",xe,[e(oe,{"current-page":m.current,"onUpdate:currentPage":l[3]||(l[3]=a=>m.current=a),"page-size":m.size,"onUpdate:pageSize":l[4]||(l[4]=a=>m.size=a),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:m.total,onSizeChange:O,onCurrentChange:q},null,8,["current-page","page-size","total"])])]),_:1}),e(K,{modelValue:v.value,"onUpdate:modelValue":l[10]||(l[10]=a=>v.value=a),title:x.value==="add"?"新增角色":"编辑角色",width:"500px"},{footer:t(()=>[u("span",Ue,[e(d,{onClick:l[9]||(l[9]=a=>v.value=!1)},{default:t(()=>[...l[24]||(l[24]=[y("取消",-1)])]),_:1}),e(d,{type:"primary",onClick:P},{default:t(()=>[...l[25]||(l[25]=[y("确定",-1)])]),_:1})])]),default:t(()=>[e(B,{model:s,rules:D,ref_key:"roleFormRef",ref:N,"label-width":"100px"},{default:t(()=>[e(c,{prop:"roleName"},{default:t(()=>[e(h,{modelValue:s.roleName,"onUpdate:modelValue":l[5]||(l[5]=a=>s.roleName=a),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),e(c,{prop:"roleKey"},{default:t(()=>[e(h,{modelValue:s.roleKey,"onUpdate:modelValue":l[6]||(l[6]=a=>s.roleKey=a),placeholder:"请输入角色代码"},null,8,["modelValue"])]),_:1}),e(c,{prop:"description"},{default:t(()=>[e(h,{modelValue:s.description,"onUpdate:modelValue":l[7]||(l[7]=a=>s.description=a),type:"textarea",placeholder:"请输入角色描述"},null,8,["modelValue"])]),_:1}),e(c,{prop:"status"},{default:t(()=>[e($,{modelValue:s.status,"onUpdate:modelValue":l[8]||(l[8]=a=>s.status=a),placeholder:"请选择状态"},{default:t(()=>[e(T,{label:"启用",value:"1"}),e(T,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(K,{modelValue:k.value,"onUpdate:modelValue":l[12]||(l[12]=a=>k.value=a),title:"菜单权限设置",width:"600px"},{footer:t(()=>[u("span",Te,[e(d,{onClick:l[11]||(l[11]=a=>k.value=!1)},{default:t(()=>[...l[26]||(l[26]=[y("取消",-1)])]),_:1}),e(d,{type:"primary",onClick:Q},{default:t(()=>[...l[27]||(l[27]=[y("确定",-1)])]),_:1})])]),default:t(()=>[e(se,{data:j.value,"show-checkbox":"","node-key":"id","default-expand-all":"","expand-on-click-node":!1,"default-checked-keys":S.value,onCheckChange:H},null,8,["data","default-checked-keys"])]),_:1},8,["modelValue"]),e(K,{modelValue:C.value,"onUpdate:modelValue":l[15]||(l[15]=a=>C.value=a),title:"用户授权设置",width:"600px"},{footer:t(()=>[u("span",Ne,[e(d,{onClick:l[14]||(l[14]=a=>C.value=!1)},{default:t(()=>[...l[28]||(l[28]=[y("取消",-1)])]),_:1}),e(d,{type:"primary",onClick:Y},{default:t(()=>[...l[29]||(l[29]=[y("确定",-1)])]),_:1})])]),default:t(()=>[e(de,{modelValue:z.value,"onUpdate:modelValue":l[13]||(l[13]=a=>z.value=a),data:A.value,titles:["可选用户","已选用户"],"button-texts":["添加","移除"],format:{noMatch:"无匹配数据",noData:"无数据",total:"共 {total} 项",filteredTotal:"共 {filteredTotal} 项"},filterable:"","filter-method":"filterMethod","filter-placeholder":"请输入搜索内容",onChange:X},null,8,["modelValue","data"])]),_:1},8,["modelValue"])])}}},Re=re(ze,[["__scopeId","data-v-aa31abab"]]);export{Re as default};
