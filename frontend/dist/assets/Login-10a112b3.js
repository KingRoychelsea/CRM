import{d as I,r as h,_ as t,a as x,u as D,o as O,b as i,c as S,e as T,f as u,g as r,w as a,h as E,i as k,j as g,t as q,E as f}from"./index-285e75c9.js";import{u as C}from"./user-eee42c1b.js";const U=I("permission",{state:()=>({routes:[],addRoutes:[]}),actions:{generateRoutes(R){return new Promise(_=>{const s=[{path:"/system",name:"System",component:()=>t(()=>import("./index-da997992.js"),["assets/index-da997992.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/user-eee42c1b.js","assets/index-16429d99.css"]),meta:{title:"系统管理",icon:"Setting"},children:[{path:"user",name:"User",component:()=>t(()=>import("./index-a3ae2100.js"),["assets/index-a3ae2100.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/index-4cfcc038.css"]),meta:{title:"用户管理",requiresAuth:!0}},{path:"role",name:"Role",component:()=>t(()=>import("./index-7f09cfbd.js"),["assets/index-7f09cfbd.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/index-108d8325.css"]),meta:{title:"角色管理",requiresAuth:!0}}]},{path:"/customer",name:"Customer",component:()=>t(()=>import("./index-da997992.js"),["assets/index-da997992.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/user-eee42c1b.js","assets/index-16429d99.css"]),meta:{title:"客户管理",icon:"UserFilled"},children:[{path:"index",name:"CustomerList",component:()=>t(()=>import("./index-8cab8cab.js"),["assets/index-8cab8cab.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/index-a5a142f5.css"]),meta:{title:"客户列表",requiresAuth:!0}}]},{path:"/sales",name:"Sales",component:()=>t(()=>import("./index-da997992.js"),["assets/index-da997992.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/user-eee42c1b.js","assets/index-16429d99.css"]),meta:{title:"销售管理",icon:"TrendCharts"},children:[{path:"opportunity",name:"Opportunity",component:()=>t(()=>import("./index-3c085be4.js"),["assets/index-3c085be4.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/index-e2b5065b.css"]),meta:{title:"商机管理",requiresAuth:!0}},{path:"contract",name:"Contract",component:()=>t(()=>import("./index-7576e524.js"),["assets/index-7576e524.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/index-41b5f460.css"]),meta:{title:"合同管理",requiresAuth:!0}},{path:"order",name:"Order",component:()=>t(()=>import("./index-dfc1a51b.js"),["assets/index-dfc1a51b.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/index-cd22955b.css"]),meta:{title:"订单管理",requiresAuth:!0}},{path:"payment",name:"Payment",component:()=>t(()=>import("./index-fb535582.js"),["assets/index-fb535582.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/index-a8e5ad32.css"]),meta:{title:"回款管理",requiresAuth:!0}}]},{path:"/stats",name:"Stats",component:()=>t(()=>import("./index-da997992.js"),["assets/index-da997992.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/user-eee42c1b.js","assets/index-16429d99.css"]),meta:{title:"数据统计",icon:"DataAnalysis"},children:[{path:"index",name:"StatsIndex",component:()=>t(()=>import("./index-d9b049f6.js"),["assets/index-d9b049f6.js","assets/index-285e75c9.js","assets/index-c98d2d50.css","assets/index-4da39481.css"]),meta:{title:"统计分析",requiresAuth:!0}}]}];s.forEach(p=>{h.addRoute(p)}),this.addRoutes=s,this.routes=h.options.routes.concat(s),_(s)})},resetRoutes(){this.routes=[],this.addRoutes=[]}}});const F={class:"login-container"},M={class:"login-box"},B={__name:"Login",setup(R){const _=D(),s=C(),p=U(),c=E(null),n=E(!1),o=k({username:"",password:"",remember:!1}),b={username:[{required:!0,message:"请输入账号",trigger:"blur"},{min:2,max:20,message:"账号长度在 2 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}]},V=async()=>{if(c.value)try{await c.value.validate(),n.value=!0;const l=await s.login(o);await s.getInfo(),await p.generateRoutes(s.roles),_.push("/dashboard"),f.success("登录成功")}catch(l){console.error("登录失败:",l),f.error("登录失败，请检查账号密码")}finally{n.value=!1}},A=()=>{f.info("请联系管理员重置密码")};return O(()=>{const l=localStorage.getItem("rememberedUsername"),e=localStorage.getItem("rememberedPassword");l&&e&&(o.username=l,o.password=e,o.remember=!0)}),(l,e)=>{const v=i("el-input"),d=i("el-form-item"),y=i("el-checkbox"),w=i("el-link"),P=i("el-button"),L=i("el-form");return S(),T("div",F,[u("div",M,[e[5]||(e[5]=u("div",{class:"login-header"},[u("h2",null,"CRM系统登录"),u("p",null,"请输入账号密码登录系统")],-1)),r(L,{model:o,rules:b,ref_key:"loginFormRef",ref:c,class:"login-form"},{default:a(()=>[r(d,{prop:"username"},{default:a(()=>[r(v,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=m=>o.username=m),placeholder:"请输入账号","prefix-icon":"User",disabled:n.value},null,8,["modelValue","disabled"])]),_:1}),r(d,{prop:"password"},{default:a(()=>[r(v,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=m=>o.password=m),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":"",disabled:n.value},null,8,["modelValue","disabled"])]),_:1}),r(d,null,{default:a(()=>[r(y,{modelValue:o.remember,"onUpdate:modelValue":e[2]||(e[2]=m=>o.remember=m)},{default:a(()=>[...e[3]||(e[3]=[g("记住密码",-1)])]),_:1},8,["modelValue"]),r(w,{type:"primary",onClick:A,class:"forgot-password"},{default:a(()=>[...e[4]||(e[4]=[g("忘记密码？",-1)])]),_:1})]),_:1}),r(d,null,{default:a(()=>[r(P,{type:"primary",class:"login-button",loading:n.value,onClick:V,disabled:n.value},{default:a(()=>[g(q(n.value?"登录中...":"登录"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["model"]),e[6]||(e[6]=u("div",{class:"login-footer"},[u("p",null,"© 2023 CRM System. All rights reserved.")],-1))])])}}},z=x(B,[["__scopeId","data-v-2189a4be"]]);export{z as default};
